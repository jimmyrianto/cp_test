<html>
        <head>
                <!-- <link rel="manifest" href="https://couch-apps.kody.work/manifest.json" /> -->
                <!-- <script type="module">
                   import 'https://cdn.jsdelivr.net/npm/@pwabuilder/pwaupdate';
                   const el = document.createElement('pwa-update');
                   document.body.appendChild(el);
                </script> -->
                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        </head>
        <body>
                <input id="test" />
                <button id="submit">Submit</button>
                <div id="result"></div>
        </body>
</html>
<script src="https://cdn.jsdelivr.net/npm/pouchdb@7.2.1/dist/pouchdb.min.js"></script>
<script>
    var db = new PouchDB('dbname');
    $("#submit").click(function() {
        db.get('submit1').then(function(doc) {
            return db.put({
                _id: 'submit1',
                _rev: doc._rev,
                title: $("#test").val(),
            });
        }).then(function(response) {
            // handle response
        }).catch(function (err) {
            db.put({
                _id: 'submit1',
                title: $("#test").val(),
            });
        });

        db.changes().on('change', function() {
            console.log('Ch-Ch-Changes');
        });

        db.replicate.to('https://admin:surabay4@couch.kody.work/db_001', {
            live: true,
            retry: true,
        });
    });

/*
    var sync = PouchDB.sync('mydb', 'https://admin:surabay4@couch.kody.work/db_001', {
        live: true,
        retry: true
    }).on('change', function (info) {
        console.log(JSON.stringify(info));
        console.log('CHANGE');

        alert(JSON.stringify(info));
        document.getElementById("result").appendChild(JSON.stringify(info));

        console.log(JSON.stringify(info));
        console.log('CHANGE');
    }).on('paused', function (err) {
    // replication paused (e.g. replication up to date, user went offline)
    }).on('active', function () {
    // replicate resumed (e.g. new changes replicating, user went back online)
    }).on('denied', function (err) {
    // a document failed to replicate (e.g. due to permissions)
    }).on('complete', function (info) {
    // handle complete
    }).on('error', function (err) {
    // handle error
    });
*/
</script>

